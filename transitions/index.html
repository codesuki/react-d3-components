<!doctype html>
<head>
    <meta charset="utf-8">
    <title>React D3 Components Examples</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="react-with-addons.js"></script>
    <script src="JSXTransformer.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.js"></script>
    <script src="react-d3-components.js"></script>
</head>
<body>
    <div id="container"></div>
    <div id="brush" class="brush"></div>
    <div id="barchart"></div>
    <div id="animatedlinechart"></div>
    <div id="barchart2"></div>
    <div id="stackedbarchart"></div>
    <div id="groupedbarchart"></div>
    <div id="scatterplot"></div>
    <div id="scatterplot2"></div>
    <div id="scatterplot3"></div>
    <div id="scatterplot4"></div>
    <div id="linechart"></div>
    <div id="linechart2"></div>
    <div id="areachart"></div>
    <div id="areachart2"></div>
    <div id="stackedareachart"></div>
    <div id="piechart"></div>

    <script type="text/jsx;harmony=true">
    var BarChart = ReactD3.BarChart;
    var PieChart = ReactD3.PieChart;
    var AreaChart = ReactD3.AreaChart;
    var ScatterPlot = ReactD3.ScatterPlot;
    var LineChart = ReactD3.LineChart;
    var Brush = ReactD3.Brush;
    var Chart = ReactD3.Chart;
    var Axis = ReactD3.Axis;

    var tooltip = function(x, y0, y, total) {
        return y.toString();
    };

    var tooltipScatter = function(x, y) {
        return "x: " + x + " y: " + y;
    };

    var tooltipPie = function(x, y) {
        return y.toString();
    };

    var tooltipArea = function(y, cumulative, x) {
        return "Total: " + cumulative + " X: " + x + " Y: " + y;
    }


    var tooltipLine = function(label, data) {
        return label + " x: " + data.x + " y: " + data.y;
    }

    /*
       var SomeComponent = React.createClass({
       getInitialState: function() {
       return {
       data: {
       label: '',
       values: [
       {x: new Date(2015, 2, 5), y: 1},
       {x: new Date(2015, 2, 6), y: 2},
       {x: new Date(2015, 2, 7), y: 0},
       {x: new Date(2015, 2, 8), y: 3},
       {x: new Date(2015, 2, 9), y: 2},
       {x: new Date(2015, 2, 10), y: 3},
       {x: new Date(2015, 2, 11), y: 4},
       {x: new Date(2015, 2, 12), y: 4},
       {x: new Date(2015, 2, 13), y: 1},
       {x: new Date(2015, 2, 14), y: 5},
       {x: new Date(2015, 2, 15), y: 0},
       {x: new Date(2015, 2, 16), y: 1},
       {x: new Date(2015, 2, 16), y: 1},
       {x: new Date(2015, 2, 18), y: 4},
       {x: new Date(2015, 2, 19), y: 4},
       {x: new Date(2015, 2, 20), y: 5},
       {x: new Date(2015, 2, 21), y: 5},
       {x: new Date(2015, 2, 22), y: 5},
       {x: new Date(2015, 2, 23), y: 1},
       {x: new Date(2015, 2, 24), y: 0},
       {x: new Date(2015, 2, 25), y: 1},
       {x: new Date(2015, 2, 26), y: 1}
       ]
       },
       xScale: d3.time.scale().domain([new Date(2015, 2, 5), new Date(2015, 2, 26)]).range([0, 400 - 70]),
       xScaleBrush: d3.time.scale().domain([new Date(2015, 2, 5), new Date(2015, 2, 26)]).range([0, 400 - 70])
       };
       },

       render: function() {
       return (
       <div>
       <LineChart
       data={this.state.data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 20}}
       xScale={this.state.xScale}
       xAxis={{tickValues: this.state.xScale.ticks(d3.time.day, 2), tickFormat: d3.time.format("%m/%d")}}
       tooltipHtml={tooltipLine}
       />
       <div className="brush" style={{float: 'none'}}>
       <Brush
       width={400}
       height={50}
       margin={{top: 0, bottom: 30, left: 50, right: 20}}
       xScale={this.state.xScaleBrush}
       extent={[new Date(2015, 2, 10), new Date(2015, 2, 12)]}
       onChange={this._onChange}
       xAxis={{tickValues: this.state.xScaleBrush.ticks(d3.time.day, 2), tickFormat: d3.time.format("%m/%d")}}
       />
       </div>
       </div>
       );
       },

       _onChange: function(extent) {
       this.setState({xScale: d3.time.scale().domain([extent[0], extent[1]]).range([0, 400 - 70])});
       }
       });

       React.render(
       <SomeComponent/>,
       document.getElementById('brush')
       );
     */

    var data = [{
        label: 'somethingA',
        values: [
            {x: 'SomethingA', y: 10},
            {x: 'SomethingB', y: 4},
            {x: 'SomethingC', y: 3}
        ]
    }];

    var transition = new ReactD3.Transition();
    transition.duration(2500)
        .attr('opacity', 1, 0)
        .attr('fill', '#c99')
        .attr('height', function(d, x, y) { return y(d.y0) - y(d.y0 + d.y); }, 0)
        .attr('y',
            function(d, x, y) { return y(d.y0 + d.y); },
            function(d, x, y) { return y(0); });

    var AnimatedBarChart = React.createClass({
        getInitialState: function() {
            return {};
        },

        componentDidMount: function() {
        },

        render: function() {
            return (
                <Chart
                    data={data}
                    width={400}
                    height={400}
                    margin={{top: 10, bottom: 50, left: 50, right: 10}}
                    tooltipHtml={tooltip}
                    transition={transition}>
                    <Axis
                        className={'x axis'}
                        orientation={'bottom'}
                        label={'Age'}
                        innerTickSize={5}
                        scale={'x'}/>
                    <Axis
                        className={"y axis"}
                        orientation={'left'}
                        label={'Funds'}
                        innerTickSize={5}
                        scale={'y'}/>
                    <BarChart/>
                </Chart>
            );
        }
    });

    React.render(<AnimatedBarChart/>, document.getElementById('barchart'));

    var AnimatedComponent = React.createClass({
        getInitialState: function() {
            return {
                data: {label: '', values: [
                    {x: 1, y: 1},
                    {x: 2, y: 2},
                    {x: 3, y: 0},
                    {x: 4, y: 1},
                    {x: 5, y: 2},
                    {x: 6, y: 0},
                    {x: 7, y: 1},
                    {x: 8, y: 2},
                    {x: 9, y: 0},
                    {x: 10, y: 1},
                    {x: 11, y: 2},
                    {x: 12, y: 0},
                    {x: 13, y: 1},
                    {x: 14, y: 2},
                    {x: 15, y: 0},
                    {x: 16, y: 1},
                    {x: 17, y: 2},
                    {x: 18, y: 0},
                    {x: 19, y: 1},
                    {x: 20, y: 2}
                ]}
            };
        },

        componentDidMount: function() {
            this._update();
        },

        _update: function() {
            var data = this.state.data;
            data.values.push({
                x: data.values[data.values.length - 1].x + 1,
                y: Math.random() - 0.5
            });

            this.setState({data: data});

            data.values.shift();

            setTimeout(this._update, 5000);
        },

        render: function() {

            var start = this.state.data.values[0].x;

            var transition = new ReactD3.Transition();
            transition
                .duration(5000)
                .attr('transform', function(d, x, y) {
                    return "translate(" + x(start - 1) + ",0)";
                }, "translate(0, 0)");

            var scale =	d3.scale.linear()
                .domain([
                    this.state.data.values[0].x,
                    this.state.data.values[this.state.data.values.length - 2].x
                ])
                .range([0, 400 - 70]);

            return (
                <Chart
                    data={this.state.data}
                    width={400}
                    height={400}
                    margin={{top: 10, bottom: 50, left: 50, right: 20}}
                    tooltipHtml={tooltipLine}
                    xScale={scale}
                    yScale={d3.scale.linear().domain([-1, 1]).range([0, 400 - 70])}
                    transition={transition}>
                    <Axis
                        className={'x axis'}
                        orientation={'bottom'}
                        label={'Age'}
                        innerTickSize={5}
                        scale={'x'}
                        transition={transition}/>
                    <Axis
                        className={"y axis"}
                        orientation={'left'}
                        label={'Funds'}
                        innerTickSize={5}
                        scale={'y'}/>
                    <LineChart/>
                </Chart>
            );
        },
    });

    React.render(
        <AnimatedComponent/>,
        document.getElementById('animatedlinechart')
    );

    var Container = React.createClass({
        getInitialState: function() {
            return {};
        },

        componentDidMount: function() {
        },

        render: function() {
            return (
                <Chart
                    data={{label:'now', values:[{x:0,y:100}, {x:1, y:200}]}}
                    width={400}
                    height={400}
                    margin={{top: 10, bottom: 50, left: 50, right: 10}}>
                    <Axis
                        className={'x axis'}
                        orientation={'bottom'}
                        label={'Age'}
                        innerTickSize={5}
                        scale={'x'}/>
                    <Axis
                        className={"y axis"}
                        orientation={'left'}
                        label={'Funds'}
                        innerTickSize={5}
                        scale={'y'}/>
                    <LineChart/>
                    <ScatterPlot/>
                </Chart>
            );
        }
    });


    React.render(
        <Container/>,
        document.getElementById('container')
    );


    data = [{
        customLabel: 'somethingA',
        customValues: [['SomethingA', 10], ['SomethingB', 4], ['SomethingC', 3]]
    }];
    var labelAccessor = function(stack) { return stack.customLabel; };
    var valuesAccessor = function(stack) { return stack.customValues; };
    var xAccessor = function(element) { return element[0]; };
    var yAccessor = function(element) { return element[1]; };

    var MyBarChart = React.createClass({
        getInitialState: function() {
            return {};
        },

        componentDidMount: function() {
        },

        render: function() {
            return (
                <Chart
                    data={data}
                    width={400}
                    height={400}
                    margin={{top: 10, bottom: 50, left: 50, right: 10}}
                    tooltipHtml={tooltip}
                    label={labelAccessor}
                    x={xAccessor}
                    y={yAccessor}
                    values={valuesAccessor}>
                    <Axis
                        className={'x axis'}
                        orientation={'bottom'}
                        label={'Age'}
                        innerTickSize={5}
                        scale={'x'}/>
                    <Axis
                        className={"y axis"}
                        orientation={'left'}
                        label={'Funds'}
                        innerTickSize={5}
                        scale={'y'}/>
                    <BarChart
                        data={data}
                        label={labelAccessor}
                        x={xAccessor}
                        y={yAccessor}
                        values={valuesAccessor}/>
                    <LineChart
                        data={data}
                        label={labelAccessor}
                        x={xAccessor}
                        y={yAccessor}
                        values={valuesAccessor}/>
                    <ScatterPlot
                        data={data}
                        label={labelAccessor}
                        x={xAccessor}
                        y={yAccessor}
                        values={valuesAccessor}/>
                </Chart>
            );
        }
    });

    React.render(<MyBarChart/>, document.getElementById('barchart2'));

    /*
       data = [
       {
       label: 'somethingA',
       values: [
       {x: 'SomethingA', y: 10},
       {x: 'SomethingB', y: 4},
       {x: 'SomethingC', y: 3}
       ]
       },
       {
       label: 'somethingB',
       values: [
       {x: 'SomethingA', y: 6},
       {x: 'SomethingB', y: 8},
       {x: 'SomethingC', y: 5}
       ]
       },
       {
       label: 'somethingC',
       values: [
       {x: 'SomethingA', y: 6},
       {x: 'SomethingB', y: 8},
       {x: 'SomethingC', y: 5}
       ]
       }
       ];

       React.render(
       <BarChart
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       tooltipHtml={tooltip}
       tooltipMode={'element'}
       />,
       document.getElementById('stackedbarchart')
       );

       React.render(
       <BarChart
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       tooltipHtml={tooltip}
       tooltipMode={'mouse'}
       groupedBars
       />,
       document.getElementById('groupedbarchart')
       );

       data = {
       label: 'somethingA',
       values: [{x: 'SomethingA', y: 10}, {x: 'SomethingB', y: 2}, {x: 'SomethingC', y: 3}]
       };

       var pieTransition = new ReactD3.Transition()
       .duration(2000)
       .ease("bounce")
       .attrTween("d", tweenPie);

       function tweenPie(b, arc) {
       b.innerRadius = 0;
       var i = d3.interpolate({startAngle: 0, endAngle: 0}, b);
       return function(t) { return arc(i(t)); };
       }

       React.render(<PieChart
       data={data}
       width={600}
       height={400}
       margin={{top: 10, bottom: 10, left: 100, right: 100}}
       tooltipOffset={{top: 175, left: 200}}
       tooltipHtml={tooltipPie}
       tooltipMode={'fixed'}
       sort={null}
       transition={pieTransition}
       />,
       document.getElementById('piechart')
       );

       data = [
       {
       label: 'somethingA',
       values: [
       {x: 0, y: 0},
       {x: 1.3, y: 5},
       {x: 3, y: 6},
       {x: 3.5, y: 6.5},
       {x: 4, y: 6},
       {x: 4.5, y: 6},
       {x: 5, y: 7},
       {x: 5.5, y: 8}
       ]
       },
       {
       label: 'somethingB',
       values: [
       {x: 0, y: 3},
       {x: 1.3, y: 4},
       {x: 3, y: 7},
       {x: 3.5, y: 8},
       {x: 4, y: 7},
       {x: 4.5, y: 7},
       {x: 5, y: 7.8},
       {x: 5.5, y: 9}
       ]
       }
       ];

       React.render(<ScatterPlot
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       tooltipHtml={tooltipScatter}
       xAxis={{innerTickSize: 6, label: "x-label"}}
       yAxis={{label: "y-label"}}
       />,
       document.getElementById('scatterplot2')
       );

       React.render(<AreaChart
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       interpolate={"basis"}
       tooltipHtml={tooltipArea}
       />,
       document.getElementById('stackedareachart')
       );

       var dashFunc = function(label) {
       if (label == "somethingA") {
       return "4 4 4";
       }
       if (label == "somethingB") {
       return "3 4 3";
       }
       }

       var widthFunc = function(label) {
       if (label == "somethingA") {
       return "4";
       }
       if (label == "somethingB") {
       return "2";
       }
       }

       React.render(<LineChart
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       tooltipHtml={tooltipLine}
       tooltipContained
       xAxis={{innerTickSize: 6, label: "x-label"}}
       yAxis={{label: "y-label"}}
       shapeColor={"red"}
       stroke={{strokeDasharray: dashFunc, strokeWidth: widthFunc}}
       />,
       document.getElementById('linechart')
       );

       data = [{
       label: 'somethingA',
       values: [{x: 0, y: 3}, {x: 1.3, y: 4}, {x: 3, y: 7}, {x: 3.5, y: 8}, {x: 4, y: 7}, {x: 4.5, y: 7}, {x: 5, y: 7.8}, {x: 5.5, y: 9}]
       }];
     */

    /*
       React.render(<ScatterPlot
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       tooltipHtml={tooltipScatter}
       />,
       document.getElementById('scatterplot')
       );
     */

    /*
       React.render(<AreaChart
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       tooltipHtml={tooltipArea}
       />,
       document.getElementById('areachart')
       );

       data = [{
       label: 'somethingA',
       values: [{x: 0, y: 3}, {x: 1.3, y: -4}, {x: 3, y: 7}, {x: -3.5, y: 8}, {x: 4, y: 7}, {x: 4.5, y: 7}, {x: 5, y: -7.8}, {x: 5.5, y: 9}, {x: -3.2, y: 5.6}]
       }];

       React.render(<ScatterPlot
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       tooltipHtml={tooltipScatter}
       xAxis={{innerTickSize: 6, label: "x-label"}}
       yAxis={{label: "y-label"}}
       />,
       document.getElementById('scatterplot3')
       );

       data = [{
       label: 'somethingA',
       values: [{x: -4, y: -3}, {x: -3.1, y: -2}, {x: -2, y: 0.5}, {x: -1, y: -1}, {x: 0, y: 0}, {x: 1, y: 1.5}, {x: 1.9, y: 2}, {x: 3, y: 4}, {x: 4, y: 5.6}]
       }];

       React.render(<LineChart
       data={data}
       width={300}
       height={300}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       tooltipHtml={tooltipLine}
       xAxis={{innerTickSize: 6, label: "x-label"}}
       yAxis={{label: "y-label"}}
       />,
       document.getElementById('linechart2')
       );
     */

    /*
       data = [{
       customLabel: 'somethingA',
       customValues: [[0, 3], [1.3, 4], [3, 7], [3.5, 8], [4, 7], [4.5, 7],  [5, 7.8]]
       }];

       var labelAccessor = function(stack) { return stack.customLabel; };
       var valuesAccessor = function(stack) { return stack.customValues; };
       var xAccessor = function(element) { return element[0]; };
       var yAccessor = function(element) { return element[1]; };

       React.render(<ScatterPlot
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       label={labelAccessor}
       x={xAccessor}
       y={yAccessor}
       values={valuesAccessor}
       tooltipHtml={tooltipScatter}/>,
       document.getElementById('scatterplot4')
       );

       React.render(<AreaChart
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       interpolate={"basis"}
       label={labelAccessor}
       x={xAccessor}
       y={yAccessor}
       values={valuesAccessor}
       tooltipHtml={tooltipArea}/>,
       document.getElementById('areachart2')
       );

       React.render(<LineChart
       data={data}
       width={400}
       height={400}
       margin={{top: 10, bottom: 50, left: 50, right: 10}}
       label={labelAccessor}
       x={xAccessor}
       y={yAccessor}
       values={valuesAccessor}
       tooltipHtml={tooltipLine}/>,
       document.getElementById('linechart2')
       );
     */
    </script>
</body>
</html>
